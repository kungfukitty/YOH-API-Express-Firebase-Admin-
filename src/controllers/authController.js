import { getAdmin } from '../config/firebase.js';import { signToken } from '../services/jwt.js';export async function login(req,res){const { email,password }=req.body||{};if(!email||!password) return res.status(400).json({error:'email and password are required'});try{const admin=getAdmin();const userRec=await admin.auth().getUserByEmail(email).catch(()=>null);if(!userRec) return res.status(401).json({error:'Invalid credentials'});const token=signToken({sub:userRec.uid,email:userRec.email,role:'member',name:userRec.displayName||undefined});res.json({token,user:{uid:userRec.uid,email:userRec.email,displayName:userRec.displayName}})}catch(e){res.status(500).json({error:'Internal error',details:e.message})}}